<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Спеки клиент-серверного взаимодействия</title>
    <style>
      pre div {
        color: green;
        display: inline;
/*         font-family:monospace; */
      }
      h3 {
        display: inline;
      }
    </style>
  </head><body>
    <pre>
<h3>клиент -&gt; сервер</h3>

var query = {
  "session_id": _sid,
  "additional_query": {
    "send_message": [
      {
        "to": _reciever_jid,
        "type": _type,
        "text": _text
      }
    ],
    <div>// манипуляции с контакт-листом</div>
    "new_contact": _jid, <div>// пока хз что там с поиском контактов / авторизацией / етц</div>
    "delete_contact": _jid,

    "change_status": {
      "show": _status_show,
      "status": _status_status
    },
    <div>// bool</div>
    "get_avatars": _bool,
    "get_roster" : _bool,
    "session_close": _bool
  }
};

<h3>сервер -&gt; клиент</h3>

var reply = {
  "messages": [
    {
      "from": _sender_jid,
      "type": _type,
      "text": _text 
    }
  ],
  "change_status": [
    {
      "jid": _jid,
      "show": _status_show,
      "status": _status_status
    }
  ],
  <div>// запрос(ы) авторизации</div>
  "auth_requests": [
    /* todo */
  ],
  <div>// получение ростера / добавление нового контакта</div>
  "new_contacts": [
    {
      "jid": _jid,
      "nick": _nick
    }
  ],
  <div>// реакция сервера на поле запроса "delete contact"</div>
  <div>// кстати хз.. нужна ли вапще какая-нить на него реакция?)</div>
  "deleted_contacts": [
    /* todo */
  ],
  "avatars": [
    {
      "jid": _jid,
      "image": _base64string
    }
  ]
};

<h3>Логин [клиент -&gt; сервер]</h3>

var login_query = {
  "jid": _jid,
  "pass": _pass,
  "host": _host
}

<h3>Логин [сервер -&gt; клиент]</h3>

var login_reply = {
  "session_id": _sid <div>// или пустая строка в случае неудачи..</div>
}


    </pre>
  </body></html>